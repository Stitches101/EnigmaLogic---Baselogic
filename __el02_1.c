//**********************************************************************************************************************************************//
//Main Function EL02_01: timestamp
//**********************************************************************************************************************************************//
void el02_1_libenigma01(EL02_1_LIBENIGMA01 *io)
{
	//Variable Input
	//**************************************************************************//
	FL in01 = 0, in02 = 0, in03 = 0;

	//Variable Output
	//**************************************************************************//
	FL ou01 = 0, ou02 = 0;
	BIT ou03 = 0;
	//Variable Local
	//**************************************************************************//


	//Read Input & Output
	//**************************************************************************//
	in01 = *io->Input01, in02 = *io->Input02, in03 = *io->Input03;
	ou01 = *io->Output01, ou02 = *io->Output02, ou03 = *io->Output03;

	//Initialization
	//**************************************************************************//
	if (PLUGIN_GetStartFlag())
	{
		*io->__s01 = 0, *io->__s02 = 0, *io->__s03 = 0, *io->__s04 = 0;
	}
	//Conditions
	//**************************************************************************//

	//Calculations
	//**************************************************************************//
	timeStamp(&in01, &in02, &in03, &ou01, &ou02, &ou03, io->__s01, io->__s02, io->__s03, io->__s04);

	//Write Output
	//**************************************************************************//
	*io->Output01 = ou01, *io->Output02 = ou02, *io->Output03 = ou03;
}

//**********************************************************************************************************************************************//
//Main Function EL02_02: Procescontroller
//**********************************************************************************************************************************************//
void el02_2_libenigma01(EL02_2_LIBENIGMA01 *io)
{
	//Variable Input
	//**************************************************************************//
	FL in05 = 0, in06 = 0, in07 = 0, in08 = 0, in09 = 0, in10 = 0,in14 = 0, in15 = 0;
	BIT in01 = 0, in02 = 0, in03 = 0, in04 = 0;
	ULI in11 = 0, in12 = 0, in13 = 0;
	//Variable Output
	//**************************************************************************//
	FL ou01 = 0, ou02 = 0, ou03 = 0, ou04 = 0, ou05 = 0, ou06 = 0, ou07 = 0;
	BIT ou08 = 0, ou11 = 0, ou12 = 0, ou13 = 0;
	ULI ou09 = 0, ou10 = 0;
	//Variable Local
	//**************************************************************************//
	FL nu01 = 0, nu02 = 0, nu03= 0, nu04 = 0, nu05 = 0, nu06 = 0, nu07 = 0;
	FL over = 0;
	FL under = 0;
	FL set = 0;
	ULI time = 0, timeout = 0;
	//Read Input & Output
	//**************************************************************************//
	in01 = *io->Input01, in02 = *io->Input02, in03 = *io->Input03, in04 = *io->Input04, in05 = *io->Input05, in06 = *io->Input06, in07 = *io->Input07, in08 = *io->Input08, in09 = *io->Input09, in10 = *io->Input10,
		in11 = *io->Input11, in12 = *io->Input12, in13 = *io->Input13, in14 = *io->Input14, in15 = *io->Input15;
	ou01 = *io->Output01, ou02 = *io->Output02, ou03 = *io->Output03, ou04 = *io->Output04, ou05 = *io->Output05, ou06 = *io->Output06, ou07 = *io->Output07, ou08 = *io->Output08, ou09 = *io->Output09, ou10 = *io->Output10,
		ou11 = *io->Output11, ou12 = *io->Output12, ou13 = *io->Output13;
	

	//Initialization
	//**************************************************************************//
	if (PLUGIN_GetStartFlag())
	{
		*io->__s01 = 0, *io->__s02 = 0, *io->__s03 = 0, *io->__s04 = 0, *io->__s05 = 0, *io->__s06 = 0, *io->__s07 = 0, *io->__s08 = 0, *io->__s09 = 0, *io->__s10 = 0;
	}
	//Conditions
	//**************************************************************************//
	time = in11 * 3600;
	//Calculations offset
	//**************************************************************************//
	over = in07 * 1.2;
	under = in07 * 0.8;
	//Calculations
	//**************************************************************************//
	timeSwitch2(&in01, &in12, &in13, &ou09, &ou10, &ou11, &ou12, &ou13, io->__s07, io->__s08, io->__s09);
	
	statusOutput(&ou11, &in02, &in03, &in04, &ou01, io->__s01);

	threeRamp(&in05, &in06, &under, &over, &in07, &in07, &over, &under, &nu07, &set, io->__s10);

	/*proportionalIntegrator(&in05, &in06, &set, &in08, &in09, &in10, &ou11, &in14, &in15,
		&ou02, &ou03, &nu01, &nu02, &ou04, &ou05, &nu03, &nu04, &nu05, &ou06, &nu06,
		io->__s02, io->__s03, io->__s04);*/

	/*bovenstaand proces uitgezet wegens een probleem met het stoppen van processen in regelaar 23-06-2021*/

	timeStampMaintenance(&ou11, &time, &timeout, &ou08, io->__s05, io->__s06);

	ou07 = timeout / 3600;

	//Write Output
	//**************************************************************************//
	*io->Output01 = ou01, *io->Output02 = ou02, *io->Output03 = ou03, *io->Output04 = ou04, *io->Output05 = ou05, *io->Output06 = ou06, *io->Output07 = ou07, *io->Output08 = ou08, *io->Output09 = ou09, *io->Output10 = ou10,
		*io->Output11 = ou11, *io->Output12 = ou12, *io->Output13 = ou13;

}

//**********************************************************************************************************************************************//
//Main Function EL02_03: Switch
//**********************************************************************************************************************************************//
void el02_3_libenigma01(EL02_3_LIBENIGMA01 *io)
{
	//Variable Input
	//**************************************************************************//
	BIT in01 = 0, in02 = 0, in04 = 0, in05 = 0;
	ULI in03 = 0;

	//Variable Output
	//**************************************************************************//
	BIT ou01 = 0, ou02 = 0;
	ULI ou03 = 0;
	//Variable Local
	//**************************************************************************//
	BIT x03 = 0;
	ULI time = 0, timeout = 0;

	//Read Input & Output
	//**************************************************************************//
	in01 = *io->Input01, in02 = *io->Input02, in03 = *io->Input03, in04 = *io->Input04, in05 = *io->Input05;
	ou01 = *io->Output01, ou02 = *io->Output02, ou03 = *io->Output03;

	//Initialization
	//**************************************************************************//
	if (PLUGIN_GetStartFlag())
	{
		*io->__s01 = 0, *io->__s02 = 0, *io->__s03 = 0;
	}
	//Calculations
	//**************************************************************************//
	if (in04 == 1 || in05 == 1)
	{
		ou01 = 1;
		ou02 = 1;
		ou03 = 0;
		*io->__s01 = 0;
	}
	else if (in01 == 1)
	{
		if (in02 == 1)
		{
			ou01 = 1;
			ou02 = 1;
			ou03 = 0;
			*io->__s01 = 0;
		 }
		else
		{
			ou01 = 0;
			ou02 = 0;
			ou03 = 0;
			*io->__s01 = 0;

		}
	}
	else if (in02 == 1)
	{
		time = in03 * 3600;
		timeStampMaintenance(&in02, &time, &timeout, &x03, io->__s01, io->__s02);
		ou03 = timeout / 3600;

		if (ou01 ==1 && ou02 == 1)
		{
			ou01 = 0;
			ou02 = 0;
		}
		else if (*io->__s03 == 0)
		{
			ou01 = 1;
			ou02 = 0;
			if (x03 == 1)
			{
				*io->__s03 = 1;
			}
		}
		else if (*io->__s03 == 1)
		{

			ou01 = 0;
			ou02 = 1;
			if (x03 == 1)
			{
				*io->__s03 = 0;
			}
		}
	}
	else
	{
		ou01 = 0;
		ou02 = 0;
	}
	
	//Write Output
	//**************************************************************************//
	*io->Output01 = ou01, *io->Output02 = ou02, *io->Output03 = ou03;
}

//**********************************************************************************************************************************************//
//Main Function EL02_04: AVG Buffer >120sec [1000]
//**********************************************************************************************************************************************//
void el02_4_libenigma01(EL02_4_LIBENIGMA01 *io)
{
	//Variable Input
	//**************************************************************************//
	FL in01 = 0;
	BIT in02 = 0;

	//Variable Output
	//**************************************************************************//
	FL ou01 = 0, ou02 = 0, ou03 = 0;

	//Variable Local
	//**************************************************************************//

	ULI x09 = 0, x10 = 0, x11 = 0;

	//Read Input & Output
	//**************************************************************************//
	in01 = *io->Input01, in02 = *io->Input02;
	ou01 = *io->Output01, ou02 = *io->Output02, ou03 = *io->Output03;


	//Initialization
	//**************************************************************************//
	if (PLUGIN_GetStartFlag() || *io->__s04 < 60)
	{
		*io->__s01 = 0, *io->__s02 = 0, *io->__s03 = 0, *io->__s05 = 0, *io->__s06 = 0;

		//Counter
		*io->__s04 += 1;

		//Buffer Clear
		for (x11 = 0; x11 < 1000; x11++)
		{
			*((io->__sa01) + x11) = 0;
		}

		ou01 = 1;
		ou03 = *io->__s04;
	}
	else
	{
		*io->__s05 += 1;
		x11 = 0;

		if (*io->__s05 == 120 && x11 == 0)
		{
			if (*io->__s06 == 0)
			{
				if (*io->__s01 < 999 && *io->__s06 == 0)
				{
					//Counter

					x09 = *io->__s01;
					*io->__s01 += 1;


					*((io->__sa01) + x09) = in01;

					//Clear Swap Memory
					*io->__s02 = 0;

					//Load Buffer
					for (x10 = 0; x10 < *io->__s01; x10++)
					{
						*io->__s02 += *((io->__sa01) + x10);
					}
					ou03 = *io->__s02 / *io->__s01;
				}
				else
				{
					//Clear Counter
					*io->__s01 = 0;
					x10 = 0;
					x09 = 0;
					*io->__s06 = 1;
				}
				ou01 = 2;
			}
			else
			{
				if (*io->__s01 < 999)
				{
					//Counter

					x09 = *io->__s01;
					*io->__s01 += 1;


					*((io->__sa01) + x09) = in01;

					//Clear Swap Memory
					*io->__s02 = 0;

					//Load Buffer
					for (x10 = 0; x10 <= 999; x10++)
					{
						*io->__s02 += *((io->__sa01) + x10);
					}

					ou03 = *io->__s02 / 999;
				}
				else
				{

					//Clear Counter
					*io->__s01 = 0;
					x10 = 0;
					x09 = 0;
				}
				ou01 = 3;
			}
			*io->__s05 = 0;
		}
	}
	if (in02 > 0)
	{
		//Clear Clean Counter
		*io->__s04 = 0;
	}

	ou02 = *io->__s01;



	//Write Output
		//**************************************************************************//
	*io->Output01 = ou01, *io->Output02 = ou02, *io->Output03 = ou03;
}

//**********************************************************************************************************************************************//
//Main Function EL02_05: AVG Buffer >600sec [1000]
//**********************************************************************************************************************************************//
void el02_5_libenigma01(EL02_5_LIBENIGMA01 *io)
{
	//Variable Input
	//**************************************************************************//
	FL in01 = 0;
	BIT in02 = 0;

	//Variable Output
	//**************************************************************************//
	FL ou01 = 0, ou02 = 0, ou03 = 0;

	//Variable Local
	//**************************************************************************//

	ULI x09 = 0, x10 = 0, x11 = 0;

	//Read Input & Output
	//**************************************************************************//
	in01 = *io->Input01, in02 = *io->Input02;
	ou01 = *io->Output01, ou02 = *io->Output02, ou03 = *io->Output03;


	//Initialization
	//**************************************************************************//
	if (PLUGIN_GetStartFlag() || *io->__s04 < 60)
	{
		*io->__s01 = 0, *io->__s02 = 0, *io->__s03 = 0, *io->__s05 = 0, *io->__s06 = 0;

		//Counter
		*io->__s04 += 1;


		//Buffer Clear
		for (x11 = 0; x11 < 1000; x11++)
		{
			*((io->__sa01) + x11) = 0;

		}

		ou01 = 1;
		ou03 = *io->__s04;
	}
	else
	{
		*io->__s05 += 1;
		x11 = 0;

		if (*io->__s05 == 600 && x11 == 0)
		{
			if (*io->__s06 == 0)
			{
				if (*io->__s01 < 999 && *io->__s06 == 0)
				{
					//Counter

					x09 = *io->__s01;
					*io->__s01 += 1;


					*((io->__sa01) + x09) = in01;

					//Clear Swap Memory
					*io->__s02 = 0;

					//Load Buffer
					for (x10 = 0; x10 < *io->__s01; x10++)
					{
						*io->__s02 += *((io->__sa01) + x10);
					}

					ou03 = *io->__s02 / *io->__s01;
				}
				else
				{

					//Clear Counter
					*io->__s01 = 0;
					x10 = 0;
					x09 = 0;
					*io->__s06 = 1;
				}
				ou01 = 2;
			}
			else
			{
				if (*io->__s01 < 999)
				{
					//Counter

					x09 = *io->__s01;
					*io->__s01 += 1;


					*((io->__sa01) + x09) = in01;

					//Clear Swap Memory
					*io->__s02 = 0;

					//Load Buffer
					for (x10 = 0; x10 <= 999; x10++)
					{
						*io->__s02 += *((io->__sa01) + x10);
					}

					ou03 = *io->__s02 / 999;
				}
				else
				{

					//Clear Counter
					*io->__s01 = 0;
					x10 = 0;
					x09 = 0;
				}
				ou01 = 3;
			}
			*io->__s05 = 0;
		}
	}
	if (in02 > 0)
	{
		//Clear Clean Counter
		*io->__s04 = 0;
	}

	ou02 = *io->__s01;



	//Write Output
		//**************************************************************************//
	*io->Output01 = ou01, *io->Output02 = ou02, *io->Output03 = ou03;
}


//**********************************************************************************************************************************************//
//Main Function EL02_06: AVG Buffer >600sec [10000] Start Stop
//**********************************************************************************************************************************************//
void el02_6_libenigma01(EL02_6_LIBENIGMA01 *io)
{
	//Variable Input
	//**************************************************************************//
	FL in01 = 0;
	BIT in02 = 0, in03 = 0;

	//Variable Output
	//**************************************************************************//
	FL ou01 = 0, ou02 = 0, ou03 = 0;

	//Variable Local
	//**************************************************************************//

	ULI x09 = 0, x10 = 0, x11 = 0;

	//Read Input & Output
	//**************************************************************************//
	in01 = *io->Input01, in02 = *io->Input02, in03 = *io->Input03;
	ou01 = *io->Output01, ou02 = *io->Output02, ou03 = *io->Output03;


	//Initialization
	//**************************************************************************//
	if (PLUGIN_GetStartFlag() || *io->__s04 < 60)
	{
		*io->__s01 = 0, *io->__s02 = 0, *io->__s03 = 0, *io->__s05 = 0, *io->__s06 = 0;

		//Counter
		*io->__s04 += 1;


		//Buffer Clear
		for (x11 = 0; x11 < 10000; x11++)
		{
			*((io->__sa01) + x11) = 0;

		}

		ou01 = 1;
		ou03 = *io->__s04;
	}
	else if(in03 == 1)
	{
		*io->__s05 += 1;
		x11 = 0;

		if (*io->__s05 == 600 && x11 == 0)
		{
			if (*io->__s06 == 0)
			{
				if (*io->__s01 < 9999 && *io->__s06 == 0)
				{
					//Counter

					x09 = *io->__s01;
					*io->__s01 += 1;


					*((io->__sa01) + x09) = in01;

					//Clear Swap Memory
					*io->__s02 = 0;

					//Load Buffer
					for (x10 = 0; x10 < *io->__s01; x10++)
					{
						*io->__s02 += *((io->__sa01) + x10);
					}

					ou03 = *io->__s02 / *io->__s01;
				}
				else
				{

					//Clear Counter
					*io->__s01 = 0;
					x10 = 0;
					x09 = 0;
					*io->__s06 = 1;
				}
				ou01 = 2;
			}
			else
			{
				if (*io->__s01 < 9999)
				{
					//Counter

					x09 = *io->__s01;
					*io->__s01 += 1;


					*((io->__sa01) + x09) = in01;

					//Clear Swap Memory
					*io->__s02 = 0;

					//Load Buffer
					for (x10 = 0; x10 <= 9999; x10++)
					{
						*io->__s02 += *((io->__sa01) + x10);
					}

					ou03 = *io->__s02 / 9999;
				}
				else
				{

					//Clear Counter
					*io->__s01 = 0;
					x10 = 0;
					x09 = 0;
				}
				ou01 = 3;
			}
			*io->__s05 = 0;
		}
	}
	else
	{
	ou01 = 4;
	*io->__s05 = 0;
	}
	if (in02 > 0)
	{
		//Clear Clean Counter
		*io->__s04 = 0;
	}
	ou02 = *io->__s01;



	//Write Output
		//**************************************************************************//
	*io->Output01 = ou01, *io->Output02 = ou02, *io->Output03 = ou03;
}


//**********************************************************************************************************************************************//
//Main Function EL02_08: AVG HEAT or COOL time
//**********************************************************************************************************************************************//
void el02_8_libenigma01(EL02_8_LIBENIGMA01 *io)
{
	//Variable Input
	//**************************************************************************//
	FL in01 = 0, in02 = 0, in03 = 0;

	//Variable Output
	//**************************************************************************//
	FL ou01 = 0, ou02 = 0, ou04= 0, ou05 = 0, ou07 = 0, ou08 = 0, ou09 = 0, ou10 = 0;
	BIT ou03 = 0, ou06 = 0;

	//Variable Local
	//**************************************************************************//


	//Read Input & Output
	//**************************************************************************//
	in01 = *io->Input01, in02 = *io->Input02, in03 = *io->Input03;
	ou01 = *io->Output01, ou02 = *io->Output02, ou03 = *io->Output03, ou04 = *io->Output04, ou05 = *io->Output05, ou06 = *io->Output06, ou07 = *io->Output07, ou08 = *io->Output08, ou09 = *io->Output09, ou10 = *io->Output10;


	//Initialization
	//**************************************************************************//
	if (PLUGIN_GetStartFlag() || *io->__r01 < 60)
	{
		*io->__s01 = 0, *io->__s02 = 0, *io->__s03 = 0, *io->__s05 = 0, *io->__s06 = 0, *io->__s07 = 0, *io->__s08 = 0, *io->__s09 = 0, *io->__s10 = 0, *io->__s11 = 0;

		//Counter
		*io->__r01 += 1;


		ou03 = 1;
		ou06 = 1;

		*io->__s12 = in01;
	}
	else
	{
		if (in02 > 0)
		{

			if (*io->__s04 == 0)
			{
				*io->__s01 += 1;
			}
			else
			{
				*io->__s01 = 0;
			}

			if (*io->__s01 == 60 || *io->__s02 == 0)
			{
				ou03 = 0;
				*io->__s01 = 0;
				*io->__s03 = in01;
				*io->__s04 = 1;
			}

			*io->__s02 += 1;
			if (*io->__s02 == 86400)
			{
				*io->__s02 = 0;
			}
			else if (*io->__s03 > 0 && *io->__s02 > 10)
			{
				ou03 = 1;

				ou02 = (((*io->__s03 - in01) / *io->__s02) * 3600);
			}
			else
			{
				ou03 = 0;
				*io->__s01 = 0;
				*io->__s02 = 0;
				*io->__s03 = 0;
				*io->__s04 = 0;
			}
		}
		else if (in03 > 0)
		{
			if (*io->__s08 == 0)
			{
				*io->__s05 += 1;
			}
			else
			{
				*io->__s05 = 0;
			}

			if (*io->__s05 == 60 || *io->__s06 == 0)
			{
				ou06 = 0;
				*io->__s05 = 0;
				*io->__s07 = in01;
				*io->__s08 = 1;
			}

			*io->__s06 += 1;
			if (*io->__s06 == 86400)
			{
				*io->__s06 = 0;
			}
			else if (*io->__s07 > 0 && *io->__s06 > 10)
			{
				ou06 = 1;

				ou04 = (((in01 - *io->__s07) / *io->__s06) * 3600);
			}
			else
			{
				ou06 = 0;
				*io->__s05 = 0;
				*io->__s06 = 0;
				*io->__s07 = 0;
				*io->__s08 = 0;
			}
		}
		else
		{
			*io->__s09 += 1;
			*io->__s10 += 1;

			if (*io->__s09 == 600)
			{
				*io->__s09 = 0;
				*io->__s11 = in01;
			}
			if (*io->__s10 == 3600)
			{
				*io->__s10 = 0;
				*io->__s12 = in01;
			}

			if (*io->__s12 > *io->__s11)
			{
				ou02 = (((*io->__s12 - *io->__s11) / 600) * 3600);
				ou03 = 1;
				ou06 = 0;
			}
			else if (*io->__s12 < *io->__s11)
			{
				ou05 = (((*io->__s11 - *io->__s12) / 600) * 3600);
				ou03 = 0;
				ou06 = 1;
			}
			else
			{
				ou03 = 0;
				ou06 = 0;
			}

		}
	}


	ou07 = *io->__s03;
	ou08 = *io->__s07;
	ou09 = *io->__s11;
	ou10 = *io->__s12;

	//Write Output
		//**************************************************************************//
	*io->Output01 = ou01, *io->Output02 = ou02, *io->Output03 = ou03, *io->Output04 = ou04, * io->Output05 = ou05, *io->Output06 = ou06, *io->Output07 = ou07, *io->Output08 = ou08, *io->Output09 = ou09, *io->Output10 = ou10;
}

//**********************************************************************************************************************************************//
//Main Function EL02_09: average
//**********************************************************************************************************************************************//
void el02_9_libenigma01(EL02_9_LIBENIGMA01 *io)
{
	//Variable Input
	//**************************************************************************//
	FL in01 = 0, in02 = 0, in03 = 0, in04 = 0, in05 = 0;

	//Variable Output
	//**************************************************************************//
	FL ou01 = 0;

	//Variable Local
	//**************************************************************************//


	//Read Input & Output
	//**************************************************************************//
	in01 = *io->Input01, in02 = *io->Input02, in03 = *io->Input03, in04 = *io->Input04, in05 = *io->Input05;
	ou01 = *io->Output01;

	//Initialization
	//**************************************************************************//

	//Conditions
	//**************************************************************************//

	//Calculations
	//**************************************************************************//
	if (in01 == 0 || in01 == 1 || in01 > 4)
	{
		ou01 = in02;
	}
	else if (in01 == 2)
	{
		ou01 = (in02 + in03) / 2;
	}
	else if (in01 == 3)
	{
		ou01 = (in02 + in03 + in04) / 3;
	}
	else if (in01 == 4)
	{
		ou01 = (in02 + in03 + in04 + in05) / 4;
	}
	//Write Output
	//**************************************************************************//
	*io->Output01 = ou01;
}





